"use strict";
/*
 * Copyright (C) 2017 - present Juergen Zimmermann, Hochschule Karlsruhe
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.saveReadable = void 0;
const mongoDB_1 = require("./mongoDB");
const logger_1 = require("../../shared/logger");
/* eslint-disable max-params */
const saveReadable = (readable, bucket, filename, metadata, client) => readable
    .pipe(bucket.openUploadStream(filename, metadata))
    .on('finish', () => {
    logger_1.logger.debug('gridfs.saveReadable(): UploadStream ist beendet');
    mongoDB_1.closeMongoDBClient(client);
});
exports.saveReadable = saveReadable;
/* eslint-enable max-params */
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JpZGZzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3NoYXJlZC9kYi9ncmlkZnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7Ozs7R0FlRzs7O0FBU0gsdUNBQStDO0FBQy9DLGdEQUE2QztBQUU3QywrQkFBK0I7QUFDeEIsTUFBTSxZQUFZLEdBQUcsQ0FDeEIsUUFBa0IsRUFDbEIsTUFBb0IsRUFDcEIsUUFBZ0IsRUFDaEIsUUFBNkMsRUFDN0MsTUFBbUIsRUFDSSxFQUFFLENBQ3pCLFFBQVE7S0FDSCxJQUFJLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQztLQUNqRCxFQUFFLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRTtJQUNmLGVBQU0sQ0FBQyxLQUFLLENBQUMsaURBQWlELENBQUMsQ0FBQztJQUNoRSw0QkFBa0IsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUMvQixDQUFDLENBQUMsQ0FBQztBQVpFLFFBQUEsWUFBWSxnQkFZZDtBQUNYLDhCQUE4QiIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTcgLSBwcmVzZW50IEp1ZXJnZW4gWmltbWVybWFubiwgSG9jaHNjaHVsZSBLYXJsc3J1aGVcbiAqXG4gKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBzb2Z0d2FyZTogeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeVxuICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnlcbiAqIHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIGVpdGhlciB2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yXG4gKiAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgcHJvZ3JhbSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGVcbiAqIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbiAqIGFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LlxuICovXG5cbmltcG9ydCB0eXBlIHtcbiAgICBHcmlkRlNCdWNrZXQsXG4gICAgR3JpZEZTQnVja2V0T3BlblVwbG9hZFN0cmVhbU9wdGlvbnMsXG4gICAgR3JpZEZTQnVja2V0V3JpdGVTdHJlYW0sXG4gICAgTW9uZ29DbGllbnQsXG59IGZyb20gJ21vbmdvZGInO1xuaW1wb3J0IHR5cGUgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7XG5pbXBvcnQgeyBjbG9zZU1vbmdvREJDbGllbnQgfSBmcm9tICcuL21vbmdvREInO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vLi4vc2hhcmVkL2xvZ2dlcic7XG5cbi8qIGVzbGludC1kaXNhYmxlIG1heC1wYXJhbXMgKi9cbmV4cG9ydCBjb25zdCBzYXZlUmVhZGFibGUgPSAoXG4gICAgcmVhZGFibGU6IFJlYWRhYmxlLFxuICAgIGJ1Y2tldDogR3JpZEZTQnVja2V0LFxuICAgIGZpbGVuYW1lOiBzdHJpbmcsXG4gICAgbWV0YWRhdGE6IEdyaWRGU0J1Y2tldE9wZW5VcGxvYWRTdHJlYW1PcHRpb25zLFxuICAgIGNsaWVudDogTW9uZ29DbGllbnQsXG4pOiBHcmlkRlNCdWNrZXRXcml0ZVN0cmVhbSA9PlxuICAgIHJlYWRhYmxlXG4gICAgICAgIC5waXBlKGJ1Y2tldC5vcGVuVXBsb2FkU3RyZWFtKGZpbGVuYW1lLCBtZXRhZGF0YSkpXG4gICAgICAgIC5vbignZmluaXNoJywgKCkgPT4ge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKCdncmlkZnMuc2F2ZVJlYWRhYmxlKCk6IFVwbG9hZFN0cmVhbSBpc3QgYmVlbmRldCcpO1xuICAgICAgICAgICAgY2xvc2VNb25nb0RCQ2xpZW50KGNsaWVudCk7XG4gICAgICAgIH0pO1xuLyogZXNsaW50LWVuYWJsZSBtYXgtcGFyYW1zICovXG4iXX0=